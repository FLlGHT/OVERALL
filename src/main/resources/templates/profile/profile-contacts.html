<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5" class="h-100">
<head>
    <meta charset="UTF-8">
    <title>Profile contacts</title>
</head>
<body>

<div th:fragment="profile-contacts" class="container px-4 py-5" id="icon-grid">
    <div class="row border-bottom">
        <h2 class="col-md-auto pb-2">Contacts</h2>
        <form class="col" th:if="${profile.canAddToContacts}" th:action="@{/add-contact}" th:object="${profile}" method="post">
        <input hidden th:field="*{id}">
        <input hidden th:field="*{username}">
        <button class="btn btn-outline-secondary" type="submit">Add</button>
    </form>
    <h2 class="text-center pb-2 text-secondary border-bottom">Contacts</h2>

    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-4 py-5">
        <div th:each="contact : ${profile.getContacts()}">
            <div class="col d-flex align-items-start">
                <svg th:if="${contact.getImageString() == null}" class="bd-placeholder-img rounded-circle me-3"
                     width="5em" height="5em" xmlns="http://www.w3.org/2000/svg" role="img"
                     aria-label="Placeholder: 140x140"
                     preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title>
                    <rect width="100%" height="100%" fill="#777"></rect>
                    <text x="50%" y="50%" fill="#777" dy=".3em">140x140</text>
                </svg>

                <img th:if="${contact.getImageString() != null}"
                     th:src="@{'data:image/png;base64, ' + ${contact.getImageString()}}" alt="#"
                     class="contact-image me-3">

                <div>
                    <p class="fw-bold mb-0 text-truncate" style="max-width: 120px"
                       th:text="${contact.getFirstName()}"></p>
                    <p class="fw-bold mb-0 text-truncate" style="max-width: 120px"
                       th:text="${contact.getSecondName()}"></p>
                    <a th:href="@{'/' + ${contact.getUsername()}}"
                       class="d-inline-block text-truncate mb-0 text-decoration-none text-muted"
                       style="max-width: 120px" th:text="${contact.getUsername()}"></a>
                    <p class="text-secondary " th:text="${contact.getOverallRating()}"></p>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center">
        <a class="btn btn-outline-secondary" th:href="@{'/' + ${profile.getUsername()} + '/contacts'}">Show all</a>
    </div>

</div>
</body>
</html>